
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒ¢ãƒªãƒ¢ãƒªã®æ£®</title>
  <style>
    body { font-family: sans-serif; background: #e6e6fa
; padding: 20px; }
    .container { max-width: 900px; margin: auto; background: #ffffff; padding: 20px; border-radius: 8px; }
    .input-group input, .input-group textarea, .input-group select { width: 100%; padding: 10px; margin: 5px 0; font-size: 1em; }
    .btn { padding: 10px; margin-top: 10px; background: #4CAF50; color: #fff; border: none; cursor: pointer; }
    .post { border: 1px solid #ccc; padding: 10px; margin-top: 10px; border-radius: 5px; }
    .username { font-weight: bold; }
    .red { color: red; }
    .delete-btn { background-color: #dc3545; color: white; padding: 3px 6px; border: none; border-radius: 3px; float: right; cursor: pointer; }
    .reply-btn { background-color: #007bff; color: white; padding: 5px; margin-top: 5px; border: none; cursor: pointer; }
    .image-preview { max-width: 100%; margin-top: 5px; border-radius: 4px; }
    .timestamp { font-size: 0.8em; color: #666; }
    .genre-select { margin-top: 10px; }
    .reply { margin-left: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ãƒ¢ãƒªãƒ¢ãƒªã®æ£®</h1>
    <h5>ã€œãƒ¢ãƒªãƒ¢ãƒªã®æ£®ã¯ãƒ•ãƒªãƒ¼æ²ç¤ºæ¿ã§ã™ã€œ</h5>
    <!-- æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="input-group">
      <input type="text" id="username" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
      <select id="genre">
        <option value="ãƒ‹ãƒ¥ãƒ¼ã‚¹">ãƒ‹ãƒ¥ãƒ¼ã‚¹</option>
        <option value="è³ªå•">è³ªå•</option>
        <option value="é›‘è«‡">é›‘è«‡</option>
     ã€€ <option value="ã‚¨ãƒ³ã‚¿ãƒ¡">ã‚¨ãƒ³ã‚¿ãƒ¡</option> <option value="å®Ÿæ³">å®Ÿæ³</option>
      </select>
      <textarea id="content" rows="3" placeholder="æŠ•ç¨¿å†…å®¹ã‚’å…¥åŠ›"></textarea>
      <input type="file" id="imageInput" accept="image/*">
      <button class="btn" onclick="addPost()">æŠ•ç¨¿</button>
    </div>

    <!-- ç®¡ç†è€…ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="input-group">
      <input type="password" id="adminPassword" placeholder="ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
      <button class="btn" onclick="loginAdmin()">ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</button>
    </div>

    <!-- ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠ -->
    <div class="genre-select">
      è¡¨ç¤ºã‚¸ãƒ£ãƒ³ãƒ«:
      <select id="filterGenre" onchange="renderPosts()">
        <option value="ã™ã¹ã¦">ã™ã¹ã¦</option>
        <option value="ãƒ‹ãƒ¥ãƒ¼ã‚¹">ãƒ‹ãƒ¥ãƒ¼ã‚¹</option>
        <option value="è³ªå•">è³ªå•</option>
        <option value="é›‘è«‡">é›‘è«‡</option>
        <option value="ã‚¨ãƒ³ã‚¿ãƒ¡">ã‚¨ãƒ³ã‚¿ãƒ¡</option>
        <option value="å®Ÿæ³">å®Ÿæ³</option>
      </select>
    </div>

    <!-- æŠ•ç¨¿ä¸€è¦§ -->
    <div id="posts"></div>
  </div>

  <script>
    const ADMIN_PASSWORD = "admin123";
    let isAdmin = false;
    let posts = [];

    function loginAdmin() {
      const pw = document.getElementById("adminPassword").value;
      if (pw === ADMIN_PASSWORD) {
        isAdmin = true;
        alert("ç®¡ç†è€…ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸ");
        renderPosts();
      } else {
        alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
      }
    }

    function addPost(parentId = null) {
      const username = document.getElementById("username").value.trim();
      const content = document.getElementById("content").value.trim();
      const genre = document.getElementById("genre").value;
      const imageInput = document.getElementById("imageInput");
      const imageFile = imageInput.files[0];

      if (!username || !content) {
        alert("ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨æŠ•ç¨¿å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const post = {
          id: Date.now(),
          username,
          content,
          parentId,
          genre,
          replies: [],
          image: imageFile ? e.target.result : null,
          timestamp: new Date().toLocaleString(),
          owner: username
        };

        if (parentId) {
          const parent = findPostById(parentId);
          parent.replies.push(post);
        } else {
          posts.push(post);
        }

        document.getElementById("content").value = "";
        imageInput.value = "";
        renderPosts();
      };

      if (imageFile) {
        reader.readAsDataURL(imageFile);
      } else {
        reader.onload({ target: { result: null } });
      }
    }

    function replyTo(postId) {
      const replyUsername = prompt("ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›:");
      if (!replyUsername) return;

      const replyContent = prompt("è¿”ä¿¡å†…å®¹ã‚’å…¥åŠ›:");
      if (!replyContent) return;

      const imageInput = document.createElement("input");
      imageInput.type = "file";
      imageInput.accept = "image/*";
      imageInput.onchange = function () {
        const file = imageInput.files[0];
        const reader = new FileReader();
        reader.onload = function (e) {
          const reply = {
            id: Date.now(),
            username: replyUsername,
            content: replyContent,
            parentId: postId,
            genre: null,
            replies: [],
            image: file ? e.target.result : null,
            timestamp: new Date().toLocaleString(),
            owner: replyUsername
          };
          const parentPost = findPostById(postId);
          parentPost.replies.push(reply);
          renderPosts();
        };
        if (file) {
          reader.readAsDataURL(file);
        } else {
          reader.onload({ target: { result: null } });
        }
      };
      imageInput.click();
    }

    function findPostById(id, list = posts) {
      for (let post of list) {
        if (post.id === id) return post;
        const found = findPostById(id, post.replies);
        if (found) return found;
      }
      return null;
    }

    function deletePost(id) {
      const username = document.getElementById("username").value.trim();
      if (!username && !isAdmin) {
        alert("ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        return;
      }

      function removePost(list) {
        return list.filter(post => {
          if (post.id === id) {
            if (post.owner === username || isAdmin) return false;
            alert("å‰Šé™¤ã§ãã¾ã›ã‚“ã€‚");
            return true;
          }
          post.replies = removePost(post.replies);
          return true;
        });
      }

      posts = removePost(posts);
      renderPosts();
    }

    function renderPosts() {
      const container = document.getElementById("posts");
      container.innerHTML = "";
      const filter = document.getElementById("filterGenre").value;

      function render(post, depth = 0) {
        if (post.parentId === null && (filter === "ã™ã¹ã¦" || post.genre === filter)) {
          const div = createPostElement(post, depth);
          container.appendChild(div);
        }
      }

      posts.forEach(post => render(post));
    }

    function createPostElement(post, depth) {
      const div = document.createElement("div");
      div.className = "post";
      div.style.marginLeft = `${depth * 20}px`;

      const usernameClass = isAdmin ? "username red" : "username";
      div.innerHTML = `
        <div>
          <span class="${usernameClass}">${post.username}</span>
          <button class="delete-btn" onclick="deletePost(${post.id})">å‰Šé™¤</button>
        </div>
        <div class="timestamp">${post.timestamp}</div>
        ${post.genre ? `<div><strong>ã‚¸ãƒ£ãƒ³ãƒ«:</strong> ${post.genre}</div>` : ""}
        <p>${post.content}</p>
        ${post.image ? `<img src="${post.image}" class="image-preview">` : ""}
        <button class="reply-btn" onclick="replyTo(${post.id})">è¿”ä¿¡</button>
      `;

      post.replies.forEach(reply => {
        const replyDiv = createPostElement(reply, depth + 1);
        div.appendChild(replyDiv);
      });

      return div;
    }

    renderPosts();
  </script>
  
  ğŸŒ³ãƒ¢ãƒªãƒ¢ãƒªã®æ£®ã®ã”åˆ©ç”¨ã¯ã”åˆ©ç”¨è€…å„ä½ã«ãŠä»»ã›ã„ãŸã—ã¾ã™ğŸŒ³ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€
  <p>ç„¡æ–­è»¢è¼‰OKã€€ã‚³ãƒ”ãƒ¼OKã€€    ã€€2025.5 ãƒ¢ãƒªãƒ¢ãƒªã®æ£®Â®ï¸</p>
 
  
</body>
</html>
